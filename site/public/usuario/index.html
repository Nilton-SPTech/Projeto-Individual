<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="../css/usuario/index.css">
    <link rel="stylesheet" href="../css/reset.css">
</head>
<body>
    


    <div class="div_modal">
        <div class="div_escolha">
            <div class="div_card">
                <div class="div_professor">
                    <img class="img_professor" src="../assets/img_usuario/professor.png">
                    <img class="img_pokemon" id="img_pokemon" src="../assets/gif/bulbassaur-animacao.gif" >

                    <img class="img_emoji" id="img_emoji">
                </div>
            </div>
            <div class="div_texto">
                <div class="div_esquerdo"></div>
                <div class="div_conversa" id="div_conversa">                    
                </div>
                <div class="div_direito"></div>
            </div>
        </div>
    </div>


    
</body>
</html>
<script src="../js/funcao_listar_pokemon.js"></script>


<script>

    texto()

    var nome = sessionStorage.NOME_USUARIO
    var vetor = [
        `Olá mestre Pokemon ${nome}!`,
        'Prazer em te conhecer, eu me chamo Professor Carvalho, e eu serei o seu guia nessa grande jornada. ',
        `proximo`, 
        `O mundo Pokemon é repleto de maravilhas e curiosidades, seus monstrinhos de bolso vão te auxiliar durante as batalhas.`,
        `Acumule pontos batalhando e chegue mais próximo do sonho de se tornar o maior mestre Pokemon.`,
        `proximo`,
        `Está preparado para viver essa aventura?`,
        `pergunta`,
        `Ótimo! Então eu irei te ajudar a escolher seu companheiro nessa grande jornada.`, 
        `Hehe, fique tranquilo. Eu sempre estarei  do seu lado caso precise de uma luz, agora vamos escolher seu companheiro para essa grande jornada.`,
        `proximo`,
        `Escolha somente um dentre os três para ser seu companheiro:`, 
        'proximo'
    ]
    
    var j = 0

    function texto(){
        div_conversa.innerHTML = ""

        if(j == 11){
            img_emoji.classList.toggle('aparecer_img_emoji')
        }

        var i = 0
        var palavra = setInterval(() => {
            
            // MOSTRANDO AS FRASES QUE NÃO SÃO 'proximo'
            if(vetor[j] != "proximo"){
                div_conversa.innerHTML += vetor[j][i] 
                
                i++
                var validar_tamanho = i == vetor[j].length 
                if(validar_tamanho){
                    i = 0
                    j++
                    console.log("Chegamos no fim")
                }
            }

            // APARECENDO A IMAGEM DO POKEMON NO BLOCO 2
            if(j == 3){
                img_pokemon.classList.toggle('aparecer_imagem_pokemon')
            }
            if(j == 6){
                img_pokemon.classList.toggle('aparecer_imagem_pokemon')
            }
            
            // VALIDANDO SE O CONTEUDO DO ARRAY É 'pergunta'
            var validar_pergunta = vetor[j] == "pergunta"
            if(validar_pergunta){
                clearInterval(palavra)
                j++
                div_conversa.innerHTML += `<br>
                <div class="div_pergunta">
                    <button onclick="pergunta('sim')">Sim</button>
                    <button onclick="pergunta('nao')">Não</button>
                </div>
                `
            }

            //VALIDANDO SE O CONTEUDO DO ARRAY É 'proximo'
            var validar_proximo = vetor[j] == "proximo"
            if(validar_proximo){
                clearInterval(palavra)
                j++
                div_conversa.innerHTML += `<br><button onclick="texto()">Prosseguir</button>`
            }
            
            // DANDO ESPAÇAMENTO CASO O CONTEUDO NÃO SEJA 'proximo' E validar_tamanho FOR VERDADEIRO
            if(!validar_proximo && validar_tamanho){
                div_conversa.innerHTML += '<br><br>'
            }
        }, 20)
    }


    // DANDO O SRC DO EMOJI
    var src_emoji = "../assets/img_usuario/"
    function pergunta(resposta){
        div_conversa.innerHTML = ""
        var i = 0

        // OPERADOR TERNÁRIO PARA VALIDAR SE A RESPOSTA É 'sim' OU 'nao'
        j = resposta == 'sim' ? 8 : 9
        // OPERADOR TERNARIO PARA VALIDAR SE O j ESTÁ NA POCIÇÃO 8 OU 9
        src_emoji += j == 8 ? "feliz_emoji.png" : "alivio_emoji.png"
        // PASSANDO O SRC PARA DENTRO DA IMG
        img_emoji.src = src_emoji
        // MOSTRANDO A IMG NA TELA
        img_emoji.classList.toggle('aparecer_img_emoji')

        // LAÇO DE REPETIÇÃO COM INTERVALO PARA PERCORRER AS FRASES
        var frase = setInterval(() => {
            if(vetor[j] != "proximo"){
                div_conversa.innerHTML += vetor[j][i] 
                
                i++
                var validar_tamanho = i == vetor[j].length 

                if(validar_tamanho){
                    // OPERADOR TERNARIO PARA VALIDAR SE O j ESTÁ NA POSIÇÃO 8 OU 9
                    j = j == 8 ? 10 : j + 1
                    i = 0
                    console.log("Chegamos no fim")
                }
            }
            if(j == 10){
                clearInterval(frase)
                j++
                div_conversa.innerHTML += `<br><button onclick="texto()">Prosseguir</button>`
            }
        }, 20)

    }
</script>